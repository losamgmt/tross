# Development & Staging Workflow
# Lightweight checks for development branches
# Fast feedback loop - lint and analyze only (no database tests)

name: Development Checks

on:
  push:
    branches-ignore: [ main ]
  pull_request:
    branches: [ develop ]

env:
  NODE_VERSION: '20'
  # Flutter 3.38.x includes Dart 3.10.x which satisfies SDK >=3.9.2 <4.0.0
  FLUTTER_VERSION: '3.38.7'

jobs:
  # Quick validation for development
  quick-checks:
    name: Quick Validation
    runs-on: ubuntu-latest

    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: ${{ env.NODE_VERSION }}
          cache: 'npm'

      - name: Install dependencies
        run: npm ci

      - name: Lint backend
        run: |
          cd backend
          npm run lint || echo "⚠️ Linting issues found - please fix"

      - name: Setup Flutter
        uses: subosito/flutter-action@v2
        with:
          flutter-version: ${{ env.FLUTTER_VERSION }}
          cache: true

      - name: Flutter analyze
        run: |
          cd frontend
          flutter pub get
          flutter analyze || echo "⚠️ Flutter analysis issues found"

      - name: Build check
        run: |
          echo "✅ Development checks complete"
          echo "Ready for testing and review"